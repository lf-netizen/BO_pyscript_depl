function t(e,n,r=[],o=[]){const c=n.filter((t=>t.source===e));return r.includes(e)?o.push(r):c&&0!==c.length?c.map((c=>t(c.target,n,[...r,e],o))):o.push([...r,e]),o.sort()}function e(t,n){return function(r=0,o=[],c={}){o[r]=t,t.forEach((t=>c[t]=!0));const i=n.filter((e=>!c[e.target]&&t.includes(e.source))).map((t=>t.target)).filter(((t,e,n)=>n.indexOf(t)==e));return i.length&&e(i,n)(r+1,o,c),o}}function n(n,r,o){const c={},i=t(n,r),u=[],l=function(t){const e=[];return t.forEach((({source:t,target:n})=>{e.find((e=>e.id===t))||e.push({id:t}),e.find((t=>t.id===n))||e.push({id:n})})),e}(r),s=o.shortestPath?e([n],r)():function(t,e){const n=new Array(e[0].length);return t.forEach((t=>{const r=e.filter((e=>e.includes(t.id)));let o=0;r.forEach((e=>{const n=e.findIndex((e=>e===t.id));n>o&&(o=n)})),n[o]=[...n[o]||[],t.id]})),n}(l,i),f=[];return s.forEach((t=>{const e=t.filter((t=>{var e;return null===(e=null==o?void 0:o.solitary)||void 0===e?void 0:e.includes(t)}));(null==e?void 0:e.length)?(f.push(e),f.push(t.filter((t=>!e.includes(t))))):f.push(t)})),i.forEach((t=>{f.forEach(((e,n)=>{const r=t.filter((t=>e.includes(t)&&!c[t]));r&&r.length>0&&(r.forEach((t=>c[t]=!0)),u[n]=[...u[n]||[],...r])}))})),o.addEmptySpots?function(t,e){return t.forEach(((n,r)=>{n.forEach(((n,o)=>{e.filter((t=>t.source===n)).forEach((e=>{const n=t.findIndex((t=>t.includes(e.target)));if(n>r+1)for(let e=r+1;e<n;e++)t[e]=[...t[e].slice(0,o),null,...t[e].slice(o)]}))}))})),t}(u,r):u}function r(t,e){const n=e.filter((e=>t.includes(e.source)&&t.includes(e.target))).map((e=>({s:t.indexOf(e.source),t:t.indexOf(e.target)}))).filter((t=>t.s>t.t+1||t.t>t.s+1));let r=0;return n.forEach((t=>r+=Math.abs(t.t-t.s)-1)),r}function o(t,e,n){const r=[...t,...e],o=n.filter((t=>r.includes(t.source)&&r.includes(t.target))).filter((e=>!(t.includes(e.source)&&t.includes(e.target)))).filter((t=>!(e.includes(t.source)&&e.includes(t.target))));let c=0;for(let t=0;t<o.length-1;t++)for(let e=t+1;e<o.length;e++){const n=[r.indexOf(o[t].source),r.indexOf(o[t].target)].sort(),i=[r.indexOf(o[e].source),r.indexOf(o[e].target)].sort();(n[0]>i[0]&&n[1]<i[1]||n[0]<i[0]&&n[1]>i[1])&&c++}return c}function c(t,e){let n=0;for(let c=0;c<t.length-1;c++){n+=r(t[c],e);for(let r=c+1;r<t.length;r++)n+=o(t[c],t[r],e)}return n}function i(t){const e=[];for(let n=0;n<t.length;n++)e[n]=t[n].slice();return e}function u(t,e,n){const r=i(t),o=t[e][n],c=t[e][n+1];return r[e][n]=c,r[e][n+1]=o,r}function l(t,e,n=0){if(0===c(t,e))return t;let r=i(t);for(let t=0;t<r.length;t++)for(let n=0;n<r[t].length-1;n++){c(u(r,t,n),e)<=c(r,e)&&(r=u(r,t,n))}return 0===c(r,e)?r:0===n&&c(r,e)<c(t,e)||n<10&&c(r,e)<c(t,e)?l(r,e,n+1):r}function s(t){function e(e,r){return l(n(e,r,t),r)}return{get:e,score:function(t,n){return c(e(t,n),n)}}}export{s as digl};
